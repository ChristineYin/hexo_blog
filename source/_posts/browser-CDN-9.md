---
title: 浏览器 之 CDN
date: 2020-05-28 22:43:22
tags:
  - 浏览器
  - CDN
categories:
  - [CDN]
excerpt: CDN 的基本原理是广泛采用各种缓存服务器，将这些缓存服务器分布到用户访问相对集中的地区或网络中，在用户访问网站时，利用全局负载技术将用户的访问指向距离最近的工作正常的缓存服务器上，由缓存服务器直接响应用户请求。 最简单的 CDN 网络由一个 DNS 服务器和几台缓存服务器就可以组成，当用户输入 URL 按下回车，经过本地 DNS 系统解析，DNS 系统会最终将域名的解析权交给 CNAME 指向的 CDN 专用 DNS 服务器，然后将得到全局负载均衡设备的 IP 地址，用户向全局负载均衡设备发送内容访问请求，全局负载均衡设备将实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上，使用户可就近取得所需内容，解决 Internet 网络拥挤的状况，提高用户访问网站的响应速度。
---

## CDN 基本原理

CDN：Content Delivery NetWork，即内容分发网络

CDN 的基本原理是广泛采用各种缓存服务器，将这些缓存服务器分布到用户访问相对集中的地区或网络中，在用户访问网站时，利用全局负载技术将用户的访问指向距离最近的工作正常的缓存服务器上，由缓存服务器直接响应用户请求。 最简单的 CDN 网络由一个 DNS 服务器和几台缓存服务器就可以组成，当用户输入 URL 按下回车，经过本地 DNS 系统解析，DNS 系统会最终将域名的解析权交给 CNAME 指向的 CDN 专用 DNS 服务器，然后将得到全局负载均衡设备的 IP 地址，用户向全局负载均衡设备发送内容访问请求，全局负载均衡设备将实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上，使用户可就近取得所需内容，解决 Internet 网络拥挤的状况，提高用户访问网站的响应速度

## CDN 过程

1. 当用户点击网站页面上的内容 url，经过本地 DNS 系统解析，DNS 系统会最终将域名的解析权叫给 CNAME 指向的 CDN 专用 DNS 服务器；
2. CDN 的 DNS 服务器将 CDN 的全局负载均衡设备 IP 地址返回给用户；
3. 用户向 CDN 的全局负载均衡设备发起内容 URL 访问请求；
4. CDN 全局负载均衡设备根据用户 IP，以及用户请求的内容 URL，选择一台用户所属区域的区域负载均衡设备，告诉用户向这台设备发起请求；
5. 区域负载均衡设备会为用户选择一台合适的缓存服务器提供服务，选择的依据包括：根据用户 IP 地址，判断哪一台服务器距离用户最近；根据用户所请求的 URL 中携带的内容名称，判断哪一台服务器上有用户所需内容；查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。基于以上这些条件的综合分析之后，区域负载均衡设备会向全局负载均衡设备返回一台缓存服务器的 IP 地址；
6. 全局负载均衡设备把服务器的 IP 地址返回给用户；
7. 用户向缓存服务器发起请求，缓存服务器应用户请求，将用户所需内容传送给用户终端。如果这台缓存服务器上并没有用户想要的内容，而区域设备依然将它分配给了用户，那么这台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉倒本地。
